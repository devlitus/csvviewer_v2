---
import type { SelectOption } from "../../lib/types";

interface Props {
  label: string;
  options: SelectOption[];
  selected?: string;
  icon?: string;
  disabled?: boolean;
  id?: string;
}

const {
  label,
  options,
  selected = options.length > 0 ? options[0].value : "",
  icon,
  disabled = false,
  id = `select-${Math.random().toString(36).substr(2, 9)}`,
} = Astro.props as Props;

// Validar que hay opciones disponibles
if (options.length === 0) {
  console.warn(`SettingsSelect "${label}": no options provided`);
}
---

<div class="space-y-1.5">
  {
    label && (
      <label for={id} class="block text-sm font-medium text-text-light-gray">
        {label}
      </label>
    )
  }
  <div class="relative">
    {
      icon && (
        <span
          class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-light-gray pointer-events-none"
          style="font-size: 20px;"
        >
          {icon}
        </span>
      )
    }
    <select
      id={id}
      value={selected}
      disabled={disabled}
      class:list={[
        "w-full bg-background-dark border border-border-dark rounded-lg py-2.5 text-text-off-white",
        "focus:ring-1 focus:ring-vibrant-blue focus:border-vibrant-blue outline-none appearance-none cursor-pointer",
        "transition-all disabled:opacity-50 disabled:cursor-not-allowed",
        icon ? "pl-10 pr-4" : "px-4",
      ]}
    >
      {
        options.length > 0 ? (
          options.map((option) => (
            <option value={option.value}>{option.text}</option>
          ))
        ) : (
          <option disabled>No options available</option>
        )
      }
    </select>
    <span
      class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-text-light-gray pointer-events-none"
      style="font-size: 20px;"
    >
      expand_more
    </span>
  </div>
</div>
